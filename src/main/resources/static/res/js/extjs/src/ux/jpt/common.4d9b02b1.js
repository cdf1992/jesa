function isIEWeb(){return!!(window.ActiveXObject||"ActiveXObject"in window)}function checkIs360(){var e=!1,n=!1;return window.navigator.appName.indexOf("Microsoft")!=-1&&(n=!0),n&&window.navigator.userProfile+""=="null"&&(e=!0),!!e}function getWebVersion(){function e(e){var n=i.exec(e);if(null!=n)return{browser:"IE",version:n[2]||"0"};var n=a.exec(e);if(null!=n)return{browser:n[1]||"",version:n[2]||"0"};var n=o.exec(e);if(null!=n)return{browser:n[1]||"",version:n[2]||"0"};var n=s.exec(e);if(null!=n)return{browser:n[1]||"",version:n[2]||"0"};var n=u.exec(e);return null!=n?{browser:n[2]||"",version:n[1]||"0"}:null!=n?{browser:"",version:"0"}:void 0}var n,t,r=navigator.userAgent,i=/(msie\s|trident.*rv:)([\w.]+)/,a=/(firefox)\/([\w.]+)/,o=/(opera).+version\/([\w.]+)/,s=/(chrome)\/([\w.]+)/,u=/version\/([\w.]+).*(safari)/,d=(r.toLowerCase(),e(r.toLowerCase()));return d.browser&&(n=d.browser,t=d.version),n}function velidateNsrsbh(e){var n=/^[0-9a-zA-Z]+$/;return""==e?(jAlert("<div id='popup_message'>读取证书信息失败，未获取到合法的纳税人信息,请重新提交请求或检查金税盘、税控盘或税务Ukey是否插入！</div>","提示",function(e){e&&(window.location.href=getDomainName())}),!1):!!n.test(e)||(jAlert("<div id='popup_message'>读取到的纳税人信息（纳税人识别号："+e+"）不合法！请重试</div>","提示"),!1)}function velidateXfsbh(e){var n=/^[0-9a-zA-Z]+$/;return""==e||0==e.length||(!!n.test(e)||(jAlert("<div id='popup_message'>请输入正确的销方税号！</div>","提示"),!1))}function checkFpdm(e){if(0!=e.length){if(10==e.length||12==e.length){var n=/^[0-9]*$/,t=n.test(e);return 0!=t||(jAlert("<div id='popup_message'>请输入正确的发票代码！</div>","提示"),!1)}return jAlert("<div id='popup_message'>请输入正确的发票代码！</div>","提示"),!1}return!0}function checkFphm(e){var n=/^\d{8}$/,t=/^0{8}$/,r=n.test(e),i=t.test(e);return 0==e.length||(1==r&&0==i||(jAlert("<div id='popup_message'>请输入正确的发票号码！</div>","提示"),!1))}function checkZnxbh(e){var n=/^[0-9a-zA-Z]+$/;return""==e||0==e.length||(!!n.test(e)||(jAlert("<div id='popup_message'>请输入正确的转内销证明编号！</div>","提示"),!1))}function checkPass(e){var n=0;return e.match(/([a-z])+/)&&n++,e.match(/([0-9])+/)&&n++,e.match(/([A-Z])+/)&&n++,e.match(/[^a-zA-Z0-9]+/)&&n++,n}function checkJkshm(e){var n=!0;if(null==e||void 0==e)n=!1;else if(22!=e.replace(" ","").length)n=!1;else{e=e.replace(" ","");var t=e.substring(0,4);if(isNaN(t)?n=!1:(n=!0,"0000"==t&&(n=!1)),n){var r=e.substring(4,8);isNaN(r)?n=!1:(n=!0,"0000"==r&&(n=!1))}if(n){var i=e.substring(4,6);"20"!=i&&(n=!1)}if(n){var a=e.substring(8,9);isNaN(a)?n=!1:(n=!0,"0"==a&&(n=!1))}if(n){var o=e.substring(9,18);isNaN(o)?n=!1:(n=!0,"000000000"==o&&(n=!1))}if(n){var s=e.substring(18,19);"-"!=s&&"/"!=s&&(n=!1)}if(n){var u=e.substring(19,20);"L"!=u&&(n=!1)}if(n){var d=e.substring(20,22);n=!isNaN(d)}}return n||jAlert("<div id='popup_message'>缴款书号码格式不正确，请重新输入！</div>","提示"),n}function getDqSsq(e){var n="",t=0;if(""==e){var r=new Date;n=r.getFullYear(),t=r.getMonth()+1}else e+="",n=e.substring(0,4),t=parseInt(e.substring(4),10);return n+"年"+t+"月"}function getDqrq(){var e=new Date,n=e.getFullYear(),t=e.getMonth()+1,r=e.getDate();return t<10&&(t="0"+t),r<10&&(r="0"+r),n+"-"+t+"-"+r}function getRzcxDate(e){var n=parseInt(e.substring(0,4),10),t=parseInt(e.substring(5,7),10);parseInt(e.substring(8),10);return 1==t?(n-=1,t=11):2==t?(n-=1,t=12):t-=2,t<10&&(t="0"+t),n+"-"+t+"-01"}function getNowDate(e){var n=new Date,t=n.getFullYear(),r=n.getMonth()+1,i=n.getDate();return 1==e?(1==r?(t-=1,r=12):r-=1,i=1):2==e&&(1==r?(r=12,t-=1):r-=1,i=getDayNum(t,r)),r<10&&(r="0"+r),i<10&&(i="0"+i),t+"-"+r+"-"+i}function getFirstDayOfMonth(e){var n="",t="";if(""==e||null==e||void 0==e){var r=new Date;n=r.getFullYear(),t=r.getMonth()+1}else n=parseInt(e.substring(0,4),10),t=parseInt(e.substring(5,7),10);return t<10&&(t="0"+t),n+"-"+t+"-01"}function getXtsj(e,n){var t=parseInt(e.substring(0,4),10),r=parseInt(e.substring(5,7),10),i=parseInt(e.substring(8),10);return 1==n?(1==r?(t-=1,r=12):r-=1,i=1):2==n&&(1==r?(r=12,t-=1):r-=1,i=getDayNum(t,r)),r<10&&(r="0"+r),i<10&&(i="0"+i),t+"-"+r+"-"+i}function getDayNum(e,n){var t=0;return t=2==n?e%4==0&&e%100!=0||e%400==0?29:28:4==n||6==n||9==n||11==n?30:31}function getFormatYuan(e){e+="";var n="",t="";if(""!=e){for(var r=e.split("."),i=r[0].length,a=(parseInt(i/3),r[0].split("")),o=i-1;o>=0;)n+=a[o],o-1>=0&&(n+=a[o-1]),o-2>=0&&(n+=a[o-2]),o-3>=0&&(n+=","),o-=3;t=n.split("").reverse().join(""),2==r.length?2==r[1].length?t+="."+r[1]:1==r[1].length?t+="."+r[1]+"0":r[1].length>2&&(t+="."+r[1].substring(0,2)):1==r.length&&(t+=".00")}else t="0";return t}function getFpfs(e){var n=0;if(""!=e){n=e;var t=e.indexOf(".");t>0&&(n=e.substring(0,t))}return n}function getXfsFpfs(e){var n=0;return""!=e&&(n=e),n}function getHxResult(e){var n="";return"1"==e?n="勾选":"0"==e&&(n="撤销"),n}function jungeIE(){var e="Y",n=myBrowser();if(n.indexOf("IE")>-1){var t=navigator.appName,r=navigator.appVersion,i=r.split(";"),a=i[1].replace(/[ ]/g,""),e="Y";"Microsoft Internet Explorer"==t&&"MSIE6.0"==a?e="N":"Microsoft Internet Explorer"==t&&"MSIE7.0"==a?e="N":"Microsoft Internet Explorer"==t&&"MSIE9.0"==a?e="N":"Microsoft Internet Explorer"==t&&"MSIE9.0"==a&&(e="N")}return e}function myBrowser(){function e(e){var n=i.exec(e);if(null!=n)return{browser:"IE",version:n[2]||"0"};var n=a.exec(e);if(null!=n)return{browser:n[1]||"",version:n[2]||"0"};var n=o.exec(e);if(null!=n)return{browser:n[1]||"",version:n[2]||"0"};var n=s.exec(e);if(null!=n)return{browser:n[1]||"",version:n[2]||"0"};var n=u.exec(e);return null!=n?{browser:n[2]||"",version:n[1]||"0"}:null!=n?{browser:"",version:"0"}:void 0}var n,t,r=navigator.userAgent,i=/(msie\s|trident.*rv:)([\w.]+)/,a=/(firefox)\/([\w.]+)/,o=/(opera).+version\/([\w.]+)/,s=/(chrome)\/([\w.]+)/,u=/version\/([\w.]+).*(safari)/,d=(r.toLowerCase(),e(r.toLowerCase()));return d.browser&&(n=d.browser,t=d.version),n+t}function getDomainName(){var e=window.location.href,n=e.lastIndexOf("/"),t=e.substring(0,n)+"/";return t}function getUrl(){var e=window.location.href,n=e.lastIndexOf("/"),t=e.substring(n+1);return t}function quit(){jConfirm("<div id='popup_message'><br/>确定退出系统？<br/></div>","确认信息",function(e){if(e){var n=getCert(),t=getCookie("token"),r=/^[0-9a-zA-Z]+$/;if(""==n||!r.test(n))return window.location=getDomainName(),clearCookie("token"),clearCookie("nsrmc"),clearCookie("dqrq"),void clearCookie("fpxzbz");$.ajax({type:"post",url:IP+"/quit.do",data:{cert:n,token:t},timeout:TIMEOUT,dataType:"jsonp",callback:"json",success:function(e){clearCookie("token"),clearCookie("nsrmc"),clearCookie("dqrq"),clearCookie("fpxzbz"),window.location=getDomainName()},error:function(){window.location=getDomainName()}})}})}function changeFormatDateYYYYMM(e){if(null==e||void 0==e)return"";var n=e.substring(0,4),t=parseInt(e.substring(5,7),10);return n+"年"+t+"月"}function changeDateYYYYMM(e){if(null==e||void 0==e)return"";var n=e.substring(0,4),t=parseInt(e.substring(4),10);return n+"年"+t+"月"}function changeDateYYYYMMDD(e){if(null==e||void 0==e)return"";var n=e.substring(0,4),t=parseInt(e.substring(4,6),10),r=parseInt(e.substring(6),10);return n+"年"+t+"月"+r+"日"}function dateYYYYandMMandDD(e){if(null==e||void 0==e)return"";var n=e.substring(0,4),t=e.substring(4,6),r=e.substring(6);return n+"-"+t+"-"+r}function changeDate(e){return null==e||void 0==e?"":e.replace(/-/g,"")}function addDate(e,n){var t=new Date(Date.parse(e.replace(/-/g,"/")));t.setDate(t.getDate()+n);var r=t.getMonth()+1,e="";return e=t.getDate()<10?"0"+t.getDate():t.getDate(),r<10&&(r="0"+r),t.getFullYear()+"-"+r+"-"+e}function getMonth(e,n){var t=new Date(e),r=t.getMonth()+1+n;r<10&&(r="0"+r);var e=getLastDay(t.getFullYear(),r);return t.getFullYear()+"-"+r+"-"+e}function getMonth(e){var n=new Date(e),t=n.getFullYear(),r=n.getMonth()+1-1;return 0==r&&(r=12,t-=1),r<10&&(r="0"+r),t+"-"+r+"-01"}function getLastDay(e,n){var t=e,r=n++;n>12&&(r-=12,t++);var i=new Date(t,r,1);return new Date(i.getTime()-864e5).getDate()}function setTab(e,n,t){for(dlfs=n,i=1;i<=t;i++){var r=document.getElementById(e+i),a=document.getElementById("con_"+e+"_"+i);r.className=i==n?"hover":"",a.style.display=i==n?"block":"none"}}function getTyslInfo(e){var n=/<TITLE>([\s\S]*?)<\/TITLE>/,t=e.match(n),r=t[0].replace("<TITLE>","").replace("</TITLE>",""),i=/<H3>([\s\S]*?)<\/H3>/,a=e.match(i),o=a[0].replace("<H3>","").replace("</H3>","").replace("<i>","").replace("</i>",""),s=/<H4>([\s\S]*?)<\/H4>/,u=e.match(s),d=u[0].replace("<H4>","").replace("</H4>",""),c=/<P>([\s\S]*?)<\/P>/,l=e.match(c),p=l[0].replace('<P><FONT FACE="Courier New">',"").replace("</FONT></P>","");return r+"\n"+o+"\n"+d+"\n"+p}function addSite(){var e="增值税发票综合服务平台",n=getDomainName();try{window.external.AddFavorite(n,e)}catch(r){try{window.sidebar.addPanel(e,n,"")}catch(e){var t="您的安全设置不允许此操作！<br />您需要手动搜藏网站：<br/><span style='color: red;'>"+n+"</span>";jAlert("<div id='popup_message'>"+t+"</div>","提示")}}}function setHome(e){var n=getDomainName();try{e.style.behavior="url(#default#homepage)",e.setHomePage(n)}catch(e){if(window.netscape)try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(e){var t="您的安全设置不允许此操作！<br />您需要手动将：<br/><span style='color: red;'>"+n+"</span><br/>设置为首页！";jAlert("<div id='popup_message'>"+t+"</div>","提示")}else{var t="您的安全设置不允许此操作！<br />您需要手动将：<br /><span style='color: red;'>"+n+"</span><br />设置为首页！";jAlert("<div id='popup_message'>"+t+"</div>","提示")}}}function toDesktop(){var e=getDomainName();try{var n=new ActiveXObject("WScript.Shell"),t=n.CreateShortcut(n.SpecialFolders("Desktop")+"\\增值税发票综合服务平台.url");t.TargetPath=e,t.Save()}catch(e){alert("快捷方式创建失败，浏览器不支持！")}}function helpInfo(e){window.open("help-"+e+".html","","dialogTop:50px;dialogWidth:1100px;dialogHeight:600px;minimize:yes;maximize:yes;")}function helpInfo_rename(e){window.open(e,"","")}function getCityName(){for(var e=new Array("https://fpdk.beijing.chinatax.gov.cn/","https://fpdk.tianjin.chinatax.gov.cn/","https://fpdk.hebei.chinatax.gov.cn/","https://fpdk.shanxi.chinatax.gov.cn/","https://fpdk.neimenggu.chinatax.gov.cn/","https://fpdk.liaoning.chinatax.gov.cn/","https://sbf.dalian.chinatax.gov.cn:8401/","https://fpdk.jilin.chinatax.gov.cn:4431/","https://fpdk.hl-n-tax.gov.cn/","https://fpdk.shanghai.chinatax.gov.cn/","https://fpdk.jiangsu.chinatax.gov.cn:81/","https://fpdk.zhejiang.chinatax.gov.cn/","https://fpdk.ningbo.chinatax.gov.cn/","https://fpdk.anhui.chinatax.gov.cn/","https://fpdk.fujian.chinatax.gov.cn/","https://fpdk.xiamen.chinatax.gov.cn/","https://fpdk.jiangxi.chinatax.gov.cn/","https://fpdk.shandong.chinatax.gov.cn/","https://fpdk.qingdao.chinatax.gov.cn/","https://fpdk.henan.chinatax.gov.cn/","https://fpdk.hubei.chinatax.gov.cn/","https://fpdk.hunan.chinatax.gov.cn/","https://fpdk.guangdong.chinatax.gov.cn/","https://fpdk.shenzhen.chinatax.gov.cn/","https://fpdk.guangxi.chinatax.gov.cn/","https://fpdk.hainan.chinatax.gov.cn/","https://fpdk.chongqing.chinatax.gov.cn/","https://fpdk.sichuan.chinatax.gov.cn/","https://fpdk.guizhou.chinatax.gov.cn/","http://fpdk.yunnan.chinatax.gov.cn/","https://fpdk.xztax.gov.cn/","https://fpdk.shaanxi.chinatax.gov.cn/","https://fpdk.gansu.chinatax.gov.cn/","https://fpdk.qinghai.chinatax.gov.cn/","https://fpdk.ningxia.chinatax.gov.cn/","https://fpdk.xj-n-tax.gov.cn/",""),n=new Array("北京","天津","河北","山西","内蒙古","辽宁","大连","吉林","黑龙江","上海","江苏","浙江","宁波","安徽","福建","厦门","江西","山东","青岛","河南","湖北","湖南","广东","深圳","广西","海南","重庆","四川","贵州","云南","西藏","陕西","甘肃","青海","宁夏","新疆","首都"),t=getDomainName(),r="",i=0;i<e.length;i++)e[i].indexOf(t)>=0&&(r=n[i]);return void 0==r||null==r||0==r.length?"":"（"+r+"）"}function doCallback(e,n){return e.apply(this,n)}function showMenu(e){var n=!0;if(null!=e&&void 0!=e){var t=e.split(MENUSPLIT);if("2"==t[1]&&$("[name='menu_dbtsgx']").hide(),"0"!=t[1]&&"1"!=t[1]||($("[name='menu_tsgx']").hide(),$("[name='menu_dbtsgx']").hide()),"1"==t[5]&&"1"==t[8]?$("[name='group_dk']").hide():"1"==t[5]&&"2"==t[8]&&"3"!=t[1]&&($("[name='menu_sy']").hide(),$("[name='menu_dkgx']").hide(),$("[name='menu_tsgx']").hide(),$("[name='menu_dbtsgx']").hide(),$("[name='menu_pzcx']").hide(),$("[name='menu_swsxtzs']").hide(),$("[name='menu_daxx']").show()),"1"==t[2]){$("[name='jxqy_menu']").show(),$("[name='scqy_menu']").hide(),$("[name='qcslr_menu']").show(),$("[name='hggjxz_jxqy_menu']").show(),$("[name='fpgjxz_menu']").show(),$("[name='mxcx_menu']").show(),$("[name='cpyhsbz_menu']").show();var r=!1;"1"==t[5]&&"2"==t[8]&&(r=!0),r||("1"==t[6]&&($("[name='fpgjxz_menu']").hide(),$("[name='ypdb_menu']").show(),$("[name='ypdbcx_menu']").show()),"1"==t[7]&&$("[name='yclykz_menu']").show())}else"2"==t[2]&&($("[name='jxqy_menu']").hide(),$("[name='scqy_menu']").show(),$("[name='xfsgzt_menu']").show(),$("[name='hggjxz_scqy_menu']").show(),$("[name='cpyfprz_menu']").show(),$("[name='cpyrztj_menu']").show(),$("[name='cpyhsbz_menu']").show())}else n=!1,jAlert_close("<div id='popup_message'>会话失效，请重新登录！</div>","提示",function(e){e&&(window.location.href=getDomainName())});return n}function checkOwner(e){var n=getCookie("token");if(setCookie("token",n,seconds),void 0==n||null==n||0==cusTrim(n).length)jAlert_close("<div id='popup_message'>会话失效，请重新登录！</div>","提示",function(e){e&&(window.location.href=getDomainName())});else{var t=getUrl();if(t.indexOf("main")<0||t.indexOf("mainpage")>=0)jAlert("<div id='popup_message'>非法的页面访问，请登录后再访问页面！</div>","提示",function(e){e&&(window.location.href=getDomainName())});else{var r=n.split(MENUSPLIT);2!=r[2]&&(e.indexOf("xfsgzt")>=0||e.indexOf("cpyfprz")>=0||e.indexOf("cpyrztj")>=0)&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()}),1!=r[6]&&(e.indexOf("ypdb.b28cdc15")>=0||e.indexOf("ypdbcx.00b92b77")>=0)&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()}),1!=r[7]&&e.indexOf("yclykz.64764692")>=0&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()}),1!=r[2]&&e.indexOf("mxcx.31d25a86")>=0&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()}),0==r[2]&&e.indexOf("hgjkslr.1f643a99")>=0&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()}),2==r[1]?e.indexOf("dbtsgx.28d5b401")>=0&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()}):3==r[1]||(e.indexOf("tsgx.4a6fb709")>=0||e.indexOf("dbtsgx.28d5b401")>=0)&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()}),"1"==r[5]&&"2"==r[8]&&"3"!=r[1]?(e.indexOf("dkgx.d49a92bc")>=0||e.indexOf("tsgx.4a6fb709")>=0||e.indexOf("dbtsgx.28d5b401")>=0||e.indexOf("pzcx")>=0||e.indexOf("dktj")>=0||e.indexOf("mainpage")>=0)&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()}):"1"==r[5]&&"1"==r[8]&&(t.indexOf("gx")>=0||t.indexOf("plgx")>=0||t.indexOf("hgprz")>=0)&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()})}}}function cusTrim(e){return e.replace(/^\s+|\s+$/gm,"")}function checkNumber(e){var n=!0,t="1234567890.",r=0;if(void 0!=e&&null!=e){var i="a"+e;if(i.length>1){for(var a=1;a<i.length;a++){var o=i.charAt(a);if(t.indexOf(o)<0){n=!1;break}"."==o&&r++}r>1&&(n=!1)}else n=!1}else n=!1;return n}function checkSkje(e){var n=/^(0|[1-9]\d*)(\s|$|\.\d{1,2}\b)/;return!!n.test(e)}function createSwspbmtree(e,n){if(void 0!=e&&null!=e){e.options.length=0,e.options.add(new Option("请选择油品"));var t=JSON.parse(n),r=t.rootnode;if(void 0!=r&&null!=r&&r.length>0)for(var i=r.split("~"),a=0;a<i.length;a++){var o=i[a].split(";"),s=document.createElement("OPTGROUP");s.label=o[1],e.appendChild(s);var u=o[0],d=t[u];if(void 0!=d&&null!=d&&d.length>0)for(var c=d.split("~"),l=0;l<c.length;l++){var p=c[l].split(";");e.options.add(new Option(p[1],p[0]))}}}}function createHgspbmtree(e,n){if(void 0!=e&&null!=e){e.options.length=0,e.options.add(new Option("请选择油品")),n=n.replace(new RegExp('\\\\"',"gm"),'"');var t=JSON.parse(n),r=t.hgsh;if(void 0!=r&&null!=r&&r.length>0)for(var i=r.split("~"),a=0;a<i.length;a++){var o=i[a].split(";"),s=t[i[a]]+"("+o[0]+")";e.options.add(new Option(s,i[a]))}}}function toFixed(e,n){var t=Math.pow(10,n),r=e*t+.5;return r=parseInt(r,10)/t,r+""}function getRandomNum(){var e=490,n=Math.random();return 10+Math.round(n*e)}function handleResult(e){var n=e.key1;if("w4000000"==n)jAlert_close("<div id='popup_message'>会话已超时，请重新登录！</div>","提示",function(e){e&&(window.location.href=getDomainName())});else if("999"==n)jAlert_error("<div id='popup_message'>请求过于频繁，请稍后再试！</div>","提示");else if("n4110089"==n)jAlert_error("<div id='popup_message'>系统业务繁忙，请稍后再试！</div>","提示");else{var t=getErrMsg(n,e.key2);jAlert_mail("<div id='popup_message'>"+t+"</div>","提示")}}function handleAjaxException(e){var n=e.statusText,t=e.status;"timeout"==n?jAlert_error("<div id='popup_message'>网络请求超时，请稍后再试！</div>","提示"):void 0==t||null==t||0==t.length?jAlert_error("<div id='popup_message'>网络无法连通，请稍后再试！(-1)</div>","提示"):jAlert_error("<div id='popup_message'>网络无法连通，请稍后再试！("+t+"："+n+")</div>","提示")}function getErrMsg(e,n){var t="操作结果！<br>";return void 0!=e&&null!=e&&e.length>0&&(t+="结果代码："+e+"<br>"),void 0!=n&&null!=n&&n.length>0&&(t+="结果信息："+n),t}function changeColor(e,n){var t=document.getElementById(e);t.style.color=n}function findSize(e){var n=window.navigator.userAgent,t=n.indexOf("MSIE 7.0")!=-1,r=n.indexOf("MSIE 8.0")!=-1,r=n.indexOf("MSIE 9.0")!=-1,i=$("#"+e);if(t||r||r)return 0;var a=i[0];return byteSize=a.files[0].size,Math.ceil(byteSize/1024)}function validate(){var e=document.getElementById("file1").value;if(""==e){jAlert("<div id='popup_message'>请您先选择需要上传的文件！</div>","提示");var n=document.getElementById("file1");return n.outerHTML=n.outerHTML,!1}var t=getCert();if(!velidateNsrsbh(t))return!1;token=getCookie("token"),$("#token").val(token),$("#cert").val(t);var r=jungeIE();$("#flag").val(r);var i=e.substr(e.length-4);if(".xls"!=i){jAlert("<div id='popup_message'>您上传的文件类型不被允许，请转换为.xls(2003版EXCEL)文件！</div>","提示");var n=document.getElementById("file1");return n.outerHTML=n.outerHTML,!1}if(findSize("file1")>500){jAlert("<div id='popup_message'>您上传的文件太大，请上传小于500K的EXCEL文件！可以通过较少上传的缴款书数量来减少文件大小。</div>","提示");var n=document.getElementById("file1");return n.outerHTML=n.outerHTML,!1}return!0}function isValNull(e){return void 0==e||null==e||0==e.trim().length}function getInputDate(e){var n=$(e).val();/^\d{4}$/.test(n)?$(e).val(n+"-"):7==n.length&&4==n.indexOf("-")&&/^\d{2}$/.test(n.substr(5,7))&&$(e).val($(e).val()+"-")}function getCert(){var e="",n=getCookie("token"),t=n.split(TOKEN_SPLIT);return e=t[1]}function getCertFromSkp(){var e="";if(0==cryptType){var n=readCertInfoApi(71,!0,alg);0==n.code&&(e=n.certInfo)}else{var t=(openDevice(),CryptCtrl.GetCertInfo("",71),CryptCtrl.errCode),e="";0==t&&(e=CryptCtrl.strResult),CryptCtrl.CloseDevice()}return e}var dlfs=1,MENUSPLIT="~",floatObj=function(){function e(e){return Math.floor(e)===e}function n(n){var t={times:1,num:0};if(e(n))return t.num=n,t;var r=n+"",i=r.indexOf("."),a=r.substr(i+1).length,o=Math.pow(10,a),s=parseInt(n*o+.5,10);return t.times=o,t.num=s,t}function t(e,t,r){var i=n(e),a=n(t),o=i.num,s=a.num,u=i.times,d=a.times,c=u>d?u:d,l=null;switch(r){case"add":return l=u===d?o+s:u>d?o+s*(u/d):o*(d/u)+s,l/c;case"subtract":return l=u===d?o-s:u>d?o-s*(u/d):o*(d/u)-s,l/c;case"multiply":return l=o*s/(u*d);case"divide":return l=o/s*(d/u)}}function r(e,n){return t(e,n,"add")}function i(e,n){return t(e,n,"subtract")}function a(e,n){return t(e,n,"multiply")}function o(e,n){return t(e,n,"divide")}return{add:r,sub:i,multi:a,divide:o}}();
function isIEWeb(){return!!(window.ActiveXObject||"ActiveXObject"in window)}function checkIs360(){var e=!1,n=!1;return window.navigator.appName.indexOf("Microsoft")!=-1&&(n=!0),n&&window.navigator.userProfile+""=="null"&&(e=!0),!!e}function getWebVersion(){function e(e){var n=i.exec(e);if(null!=n)return{browser:"IE",version:n[2]||"0"};var n=a.exec(e);if(null!=n)return{browser:n[1]||"",version:n[2]||"0"};var n=o.exec(e);if(null!=n)return{browser:n[1]||"",version:n[2]||"0"};var n=s.exec(e);if(null!=n)return{browser:n[1]||"",version:n[2]||"0"};var n=u.exec(e);return null!=n?{browser:n[2]||"",version:n[1]||"0"}:null!=n?{browser:"",version:"0"}:void 0}var n,t,r=navigator.userAgent,i=/(msie\s|trident.*rv:)([\w.]+)/,a=/(firefox)\/([\w.]+)/,o=/(opera).+version\/([\w.]+)/,s=/(chrome)\/([\w.]+)/,u=/version\/([\w.]+).*(safari)/,d=(r.toLowerCase(),e(r.toLowerCase()));return d.browser&&(n=d.browser,t=d.version),n}function velidateNsrsbh(e){var n=/^[0-9a-zA-Z]+$/;return""==e?(jAlert("<div id='popup_message'>读取证书信息失败，未获取到合法的纳税人信息,请重新提交请求或检查金税盘、税控盘或税务Ukey是否插入！</div>","提示",function(e){e&&(window.location.href=getDomainName())}),!1):!!n.test(e)||(jAlert("<div id='popup_message'>读取到的纳税人信息（纳税人识别号："+e+"）不合法！请重试</div>","提示"),!1)}function velidateXfsbh(e){var n=/^[0-9a-zA-Z]+$/;return""==e||0==e.length||(!!n.test(e)||(jAlert("<div id='popup_message'>请输入正确的销方税号！</div>","提示"),!1))}function checkFpdm(e){if(0!=e.length){if(10==e.length||12==e.length){var n=/^[0-9]*$/,t=n.test(e);return 0!=t||(jAlert("<div id='popup_message'>请输入正确的发票代码！</div>","提示"),!1)}return jAlert("<div id='popup_message'>请输入正确的发票代码！</div>","提示"),!1}return!0}function checkFphm(e){var n=/^\d{8}$/,t=/^0{8}$/,r=n.test(e),i=t.test(e);return 0==e.length||(1==r&&0==i||(jAlert("<div id='popup_message'>请输入正确的发票号码！</div>","提示"),!1))}function checkZnxbh(e){var n=/^[0-9a-zA-Z]+$/;return""==e||0==e.length||(!!n.test(e)||(jAlert("<div id='popup_message'>请输入正确的转内销证明编号！</div>","提示"),!1))}function checkPass(e){var n=0;return e.match(/([a-z])+/)&&n++,e.match(/([0-9])+/)&&n++,e.match(/([A-Z])+/)&&n++,e.match(/[^a-zA-Z0-9]+/)&&n++,n}function checkJkshm(e){var n=!0;if(null==e||void 0==e)n=!1;else if(22!=e.replace(" ","").length)n=!1;else{e=e.replace(" ","");var t=e.substring(0,4);if(isNaN(t)?n=!1:(n=!0,"0000"==t&&(n=!1)),n){var r=e.substring(4,8);isNaN(r)?n=!1:(n=!0,"0000"==r&&(n=!1))}if(n){var i=e.substring(4,6);"20"!=i&&(n=!1)}if(n){var a=e.substring(8,9);isNaN(a)?n=!1:(n=!0,"0"==a&&(n=!1))}if(n){var o=e.substring(9,18);isNaN(o)?n=!1:(n=!0,"000000000"==o&&(n=!1))}if(n){var s=e.substring(18,19);"-"!=s&&"/"!=s&&(n=!1)}if(n){var u=e.substring(19,20);"L"!=u&&(n=!1)}if(n){var d=e.substring(20,22);n=!isNaN(d)}}return n||jAlert("<div id='popup_message'>缴款书号码格式不正确，请重新输入！</div>","提示"),n}function getDqSsq(e){var n="",t=0;if(""==e){var r=new Date;n=r.getFullYear(),t=r.getMonth()+1}else e+="",n=e.substring(0,4),t=parseInt(e.substring(4),10);return n+"年"+t+"月"}function getDqrq(){var e=new Date,n=e.getFullYear(),t=e.getMonth()+1,r=e.getDate();return t<10&&(t="0"+t),r<10&&(r="0"+r),n+"-"+t+"-"+r}function getRzcxDate(e){var n=parseInt(e.substring(0,4),10),t=parseInt(e.substring(5,7),10);parseInt(e.substring(8),10);return 1==t?(n-=1,t=11):2==t?(n-=1,t=12):t-=2,t<10&&(t="0"+t),n+"-"+t+"-01"}function getNowDate(e){var n=new Date,t=n.getFullYear(),r=n.getMonth()+1,i=n.getDate();return 1==e?(1==r?(t-=1,r=12):r-=1,i=1):2==e&&(1==r?(r=12,t-=1):r-=1,i=getDayNum(t,r)),r<10&&(r="0"+r),i<10&&(i="0"+i),t+"-"+r+"-"+i}function getFirstDayOfMonth(e){var n="",t="";if(""==e||null==e||void 0==e){var r=new Date;n=r.getFullYear(),t=r.getMonth()+1}else n=parseInt(e.substring(0,4),10),t=parseInt(e.substring(5,7),10);return t<10&&(t="0"+t),n+"-"+t+"-01"}function getXtsj(e,n){var t=parseInt(e.substring(0,4),10),r=parseInt(e.substring(5,7),10),i=parseInt(e.substring(8),10);return 1==n?(1==r?(t-=1,r=12):r-=1,i=1):2==n&&(1==r?(r=12,t-=1):r-=1,i=getDayNum(t,r)),r<10&&(r="0"+r),i<10&&(i="0"+i),t+"-"+r+"-"+i}function getDayNum(e,n){var t=0;return t=2==n?e%4==0&&e%100!=0||e%400==0?29:28:4==n||6==n||9==n||11==n?30:31}function getFormatYuan(e){e+="";var n="",t="";if(""!=e){for(var r=e.split("."),i=r[0].length,a=(parseInt(i/3),r[0].split("")),o=i-1;o>=0;)n+=a[o],o-1>=0&&(n+=a[o-1]),o-2>=0&&(n+=a[o-2]),o-3>=0&&(n+=","),o-=3;t=n.split("").reverse().join(""),2==r.length?2==r[1].length?t+="."+r[1]:1==r[1].length?t+="."+r[1]+"0":r[1].length>2&&(t+="."+r[1].substring(0,2)):1==r.length&&(t+=".00")}else t="0";return t}function getFpfs(e){var n=0;if(""!=e){n=e;var t=e.indexOf(".");t>0&&(n=e.substring(0,t))}return n}function getXfsFpfs(e){var n=0;return""!=e&&(n=e),n}function getHxResult(e){var n="";return"1"==e?n="勾选":"0"==e&&(n="撤销"),n}function jungeIE(){var e="Y",n=myBrowser();if(n.indexOf("IE")>-1){var t=navigator.appName,r=navigator.appVersion,i=r.split(";"),a=i[1].replace(/[ ]/g,""),e="Y";"Microsoft Internet Explorer"==t&&"MSIE6.0"==a?e="N":"Microsoft Internet Explorer"==t&&"MSIE7.0"==a?e="N":"Microsoft Internet Explorer"==t&&"MSIE9.0"==a?e="N":"Microsoft Internet Explorer"==t&&"MSIE9.0"==a&&(e="N")}return e}function myBrowser(){function e(e){var n=i.exec(e);if(null!=n)return{browser:"IE",version:n[2]||"0"};var n=a.exec(e);if(null!=n)return{browser:n[1]||"",version:n[2]||"0"};var n=o.exec(e);if(null!=n)return{browser:n[1]||"",version:n[2]||"0"};var n=s.exec(e);if(null!=n)return{browser:n[1]||"",version:n[2]||"0"};var n=u.exec(e);return null!=n?{browser:n[2]||"",version:n[1]||"0"}:null!=n?{browser:"",version:"0"}:void 0}var n,t,r=navigator.userAgent,i=/(msie\s|trident.*rv:)([\w.]+)/,a=/(firefox)\/([\w.]+)/,o=/(opera).+version\/([\w.]+)/,s=/(chrome)\/([\w.]+)/,u=/version\/([\w.]+).*(safari)/,d=(r.toLowerCase(),e(r.toLowerCase()));return d.browser&&(n=d.browser,t=d.version),n+t}function getDomainName(){var e=window.location.href,n=e.lastIndexOf("/"),t=e.substring(0,n)+"/";return t}function getUrl(){var e=window.location.href,n=e.lastIndexOf("/"),t=e.substring(n+1);return t}function quit(){jConfirm("<div id='popup_message'><br/>确定退出系统？<br/></div>","确认信息",function(e){if(e){var n=getCert(),t=getCookie("token"),r=/^[0-9a-zA-Z]+$/;if(""==n||!r.test(n))return window.location=getDomainName(),clearCookie("token"),clearCookie("nsrmc"),clearCookie("dqrq"),void clearCookie("fpxzbz");$.ajax({type:"post",url:IP+"/quit.do",data:{cert:n,token:t},timeout:TIMEOUT,dataType:"jsonp",callback:"json",success:function(e){clearCookie("token"),clearCookie("nsrmc"),clearCookie("dqrq"),clearCookie("fpxzbz"),window.location=getDomainName()},error:function(){window.location=getDomainName()}})}})}function changeFormatDateYYYYMM(e){if(null==e||void 0==e)return"";var n=e.substring(0,4),t=parseInt(e.substring(5,7),10);return n+"年"+t+"月"}function changeDateYYYYMM(e){if(null==e||void 0==e)return"";var n=e.substring(0,4),t=parseInt(e.substring(4),10);return n+"年"+t+"月"}function changeDateYYYYMMDD(e){if(null==e||void 0==e)return"";var n=e.substring(0,4),t=parseInt(e.substring(4,6),10),r=parseInt(e.substring(6),10);return n+"年"+t+"月"+r+"日"}function dateYYYYandMMandDD(e){if(null==e||void 0==e)return"";var n=e.substring(0,4),t=e.substring(4,6),r=e.substring(6);return n+"-"+t+"-"+r}function changeDate(e){return null==e||void 0==e?"":e.replace(/-/g,"")}function addDate(e,n){var t=new Date(Date.parse(e.replace(/-/g,"/")));t.setDate(t.getDate()+n);var r=t.getMonth()+1,e="";return e=t.getDate()<10?"0"+t.getDate():t.getDate(),r<10&&(r="0"+r),t.getFullYear()+"-"+r+"-"+e}function getMonth(e,n){var t=new Date(e),r=t.getMonth()+1+n;r<10&&(r="0"+r);var e=getLastDay(t.getFullYear(),r);return t.getFullYear()+"-"+r+"-"+e}function getMonth(e){var n=new Date(e),t=n.getFullYear(),r=n.getMonth()+1-1;return 0==r&&(r=12,t-=1),r<10&&(r="0"+r),t+"-"+r+"-01"}function getLastDay(e,n){var t=e,r=n++;n>12&&(r-=12,t++);var i=new Date(t,r,1);return new Date(i.getTime()-864e5).getDate()}function setTab(e,n,t){for(dlfs=n,i=1;i<=t;i++){var r=document.getElementById(e+i),a=document.getElementById("con_"+e+"_"+i);r.className=i==n?"hover":"",a.style.display=i==n?"block":"none"}}function getTyslInfo(e){var n=/<TITLE>([\s\S]*?)<\/TITLE>/,t=e.match(n),r=t[0].replace("<TITLE>","").replace("</TITLE>",""),i=/<H3>([\s\S]*?)<\/H3>/,a=e.match(i),o=a[0].replace("<H3>","").replace("</H3>","").replace("<i>","").replace("</i>",""),s=/<H4>([\s\S]*?)<\/H4>/,u=e.match(s),d=u[0].replace("<H4>","").replace("</H4>",""),c=/<P>([\s\S]*?)<\/P>/,l=e.match(c),p=l[0].replace('<P><FONT FACE="Courier New">',"").replace("</FONT></P>","");return r+"\n"+o+"\n"+d+"\n"+p}function addSite(){var e="增值税发票综合服务平台",n=getDomainName();try{window.external.AddFavorite(n,e)}catch(r){try{window.sidebar.addPanel(e,n,"")}catch(e){var t="您的安全设置不允许此操作！<br />您需要手动搜藏网站：<br/><span style='color: red;'>"+n+"</span>";jAlert("<div id='popup_message'>"+t+"</div>","提示")}}}function setHome(e){var n=getDomainName();try{e.style.behavior="url(#default#homepage)",e.setHomePage(n)}catch(e){if(window.netscape)try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(e){var t="您的安全设置不允许此操作！<br />您需要手动将：<br/><span style='color: red;'>"+n+"</span><br/>设置为首页！";jAlert("<div id='popup_message'>"+t+"</div>","提示")}else{var t="您的安全设置不允许此操作！<br />您需要手动将：<br /><span style='color: red;'>"+n+"</span><br />设置为首页！";jAlert("<div id='popup_message'>"+t+"</div>","提示")}}}function toDesktop(){var e=getDomainName();try{var n=new ActiveXObject("WScript.Shell"),t=n.CreateShortcut(n.SpecialFolders("Desktop")+"\\增值税发票综合服务平台.url");t.TargetPath=e,t.Save()}catch(e){alert("快捷方式创建失败，浏览器不支持！")}}function helpInfo(e){window.open("help-"+e+".html","","dialogTop:50px;dialogWidth:1100px;dialogHeight:600px;minimize:yes;maximize:yes;")}function helpInfo_rename(e){window.open(e,"","")}function getCityName(){for(var e=new Array("https://fpdk.beijing.chinatax.gov.cn/","https://fpdk.tianjin.chinatax.gov.cn/","https://fpdk.hebei.chinatax.gov.cn/","https://fpdk.shanxi.chinatax.gov.cn/","https://fpdk.neimenggu.chinatax.gov.cn/","https://fpdk.liaoning.chinatax.gov.cn/","https://sbf.dalian.chinatax.gov.cn:8401/","https://fpdk.jilin.chinatax.gov.cn:4431/","https://fpdk.hl-n-tax.gov.cn/","https://fpdk.shanghai.chinatax.gov.cn/","https://fpdk.jiangsu.chinatax.gov.cn:81/","https://fpdk.zhejiang.chinatax.gov.cn/","https://fpdk.ningbo.chinatax.gov.cn/","https://fpdk.anhui.chinatax.gov.cn/","https://fpdk.fujian.chinatax.gov.cn/","https://fpdk.xiamen.chinatax.gov.cn/","https://fpdk.jiangxi.chinatax.gov.cn/","https://fpdk.shandong.chinatax.gov.cn/","https://fpdk.qingdao.chinatax.gov.cn/","https://fpdk.henan.chinatax.gov.cn/","https://fpdk.hubei.chinatax.gov.cn/","https://fpdk.hunan.chinatax.gov.cn/","https://fpdk.guangdong.chinatax.gov.cn/","https://fpdk.shenzhen.chinatax.gov.cn/","https://fpdk.guangxi.chinatax.gov.cn/","https://fpdk.hainan.chinatax.gov.cn/","https://fpdk.chongqing.chinatax.gov.cn/","https://fpdk.sichuan.chinatax.gov.cn/","https://fpdk.guizhou.chinatax.gov.cn/","http://fpdk.yunnan.chinatax.gov.cn/","https://fpdk.xztax.gov.cn/","https://fpdk.shaanxi.chinatax.gov.cn/","https://fpdk.gansu.chinatax.gov.cn/","https://fpdk.qinghai.chinatax.gov.cn/","https://fpdk.ningxia.chinatax.gov.cn/","https://fpdk.xj-n-tax.gov.cn/",""),n=new Array("北京","天津","河北","山西","内蒙古","辽宁","大连","吉林","黑龙江","上海","江苏","浙江","宁波","安徽","福建","厦门","江西","山东","青岛","河南","湖北","湖南","广东","深圳","广西","海南","重庆","四川","贵州","云南","西藏","陕西","甘肃","青海","宁夏","新疆","首都"),t=getDomainName(),r="",i=0;i<e.length;i++)e[i].indexOf(t)>=0&&(r=n[i]);return void 0==r||null==r||0==r.length?"":"（"+r+"）"}function doCallback(e,n){return e.apply(this,n)}function showMenu(e){var n=!0;if(null!=e&&void 0!=e){var t=e.split(MENUSPLIT);if("2"==t[1]&&$("[name='menu_dbtsgx']").hide(),"0"!=t[1]&&"1"!=t[1]||($("[name='menu_tsgx']").hide(),$("[name='menu_dbtsgx']").hide()),"1"==t[5]&&"1"==t[8]?$("[name='group_dk']").hide():"1"==t[5]&&"2"==t[8]&&"3"!=t[1]&&($("[name='menu_sy']").hide(),$("[name='menu_dkgx']").hide(),$("[name='menu_tsgx']").hide(),$("[name='menu_dbtsgx']").hide(),$("[name='menu_pzcx']").hide(),$("[name='menu_swsxtzs']").hide(),$("[name='menu_daxx']").show()),"1"==t[2]){$("[name='jxqy_menu']").show(),$("[name='scqy_menu']").hide(),$("[name='qcslr_menu']").show(),$("[name='hggjxz_jxqy_menu']").show(),$("[name='fpgjxz_menu']").show(),$("[name='mxcx_menu']").show(),$("[name='cpyhsbz_menu']").show();var r=!1;"1"==t[5]&&"2"==t[8]&&(r=!0),r||("1"==t[6]&&($("[name='fpgjxz_menu']").hide(),$("[name='ypdb_menu']").show(),$("[name='ypdbcx_menu']").show()),"1"==t[7]&&$("[name='yclykz_menu']").show())}else"2"==t[2]&&($("[name='jxqy_menu']").hide(),$("[name='scqy_menu']").show(),$("[name='xfsgzt_menu']").show(),$("[name='hggjxz_scqy_menu']").show(),$("[name='cpyfprz_menu']").show(),$("[name='cpyrztj_menu']").show(),$("[name='cpyhsbz_menu']").show())}else n=!1,jAlert_close("<div id='popup_message'>会话失效，请重新登录！</div>","提示",function(e){e&&(window.location.href=getDomainName())});return n}function checkOwner(e){var n=getCookie("token");if(setCookie("token",n,seconds),void 0==n||null==n||0==cusTrim(n).length)jAlert_close("<div id='popup_message'>会话失效，请重新登录！</div>","提示",function(e){e&&(window.location.href=getDomainName())});else{var t=getUrl();if(t.indexOf("main")<0||t.indexOf("mainpage")>=0)jAlert("<div id='popup_message'>非法的页面访问，请登录后再访问页面！</div>","提示",function(e){e&&(window.location.href=getDomainName())});else{var r=n.split(MENUSPLIT);2!=r[2]&&(e.indexOf("xfsgzt")>=0||e.indexOf("cpyfprz")>=0||e.indexOf("cpyrztj")>=0)&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()}),1!=r[6]&&(e.indexOf("ypdb.b28cdc15")>=0||e.indexOf("ypdbcx.00b92b77")>=0)&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()}),1!=r[7]&&e.indexOf("yclykz.64764692")>=0&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()}),1!=r[2]&&e.indexOf("mxcx.31d25a86")>=0&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()}),0==r[2]&&e.indexOf("hgjkslr.1f643a99")>=0&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()}),2==r[1]?e.indexOf("dbtsgx.28d5b401")>=0&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()}):3==r[1]||(e.indexOf("tsgx.4a6fb709")>=0||e.indexOf("dbtsgx.28d5b401")>=0)&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()}),"1"==r[5]&&"2"==r[8]&&"3"!=r[1]?(e.indexOf("dkgx.d49a92bc")>=0||e.indexOf("tsgx.4a6fb709")>=0||e.indexOf("dbtsgx.28d5b401")>=0||e.indexOf("pzcx")>=0||e.indexOf("dktj")>=0||e.indexOf("mainpage")>=0)&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()}):"1"==r[5]&&"1"==r[8]&&(t.indexOf("gx")>=0||t.indexOf("plgx")>=0||t.indexOf("hgprz")>=0)&&jAlert("<div id='popup_message'>您没有此功能权限！</div>","提示",function(e){window.location.href=getDomainName()})}}}function cusTrim(e){return e.replace(/^\s+|\s+$/gm,"")}function checkNumber(e){var n=!0,t="1234567890.",r=0;if(void 0!=e&&null!=e){var i="a"+e;if(i.length>1){for(var a=1;a<i.length;a++){var o=i.charAt(a);if(t.indexOf(o)<0){n=!1;break}"."==o&&r++}r>1&&(n=!1)}else n=!1}else n=!1;return n}function checkSkje(e){var n=/^(0|[1-9]\d*)(\s|$|\.\d{1,2}\b)/;return!!n.test(e)}function createSwspbmtree(e,n){if(void 0!=e&&null!=e){e.options.length=0,e.options.add(new Option("请选择油品"));var t=JSON.parse(n),r=t.rootnode;if(void 0!=r&&null!=r&&r.length>0)for(var i=r.split("~"),a=0;a<i.length;a++){var o=i[a].split(";"),s=document.createElement("OPTGROUP");s.label=o[1],e.appendChild(s);var u=o[0],d=t[u];if(void 0!=d&&null!=d&&d.length>0)for(var c=d.split("~"),l=0;l<c.length;l++){var p=c[l].split(";");e.options.add(new Option(p[1],p[0]))}}}}function createHgspbmtree(e,n){if(void 0!=e&&null!=e){e.options.length=0,e.options.add(new Option("请选择油品")),n=n.replace(new RegExp('\\\\"',"gm"),'"');var t=JSON.parse(n),r=t.hgsh;if(void 0!=r&&null!=r&&r.length>0)for(var i=r.split("~"),a=0;a<i.length;a++){var o=i[a].split(";"),s=t[i[a]]+"("+o[0]+")";e.options.add(new Option(s,i[a]))}}}function toFixed(e,n){var t=Math.pow(10,n),r=e*t+.5;return r=parseInt(r,10)/t,r+""}function getRandomNum(){var e=490,n=Math.random();return 10+Math.round(n*e)}function handleResult(e){var n=e.key1;if("w4000000"==n)jAlert_close("<div id='popup_message'>会话已超时，请重新登录！</div>","提示",function(e){e&&(window.location.href=getDomainName())});else if("999"==n)jAlert_error("<div id='popup_message'>请求过于频繁，请稍后再试！</div>","提示");else if("n4110089"==n)jAlert_error("<div id='popup_message'>系统业务繁忙，请稍后再试！</div>","提示");else{var t=getErrMsg(n,e.key2);jAlert_mail("<div id='popup_message'>"+t+"</div>","提示")}}function handleAjaxException(e){var n=e.statusText,t=e.status;"timeout"==n?jAlert_error("<div id='popup_message'>网络请求超时，请稍后再试！</div>","提示"):void 0==t||null==t||0==t.length?jAlert_error("<div id='popup_message'>网络无法连通，请稍后再试！(-1)</div>","提示"):jAlert_error("<div id='popup_message'>网络无法连通，请稍后再试！("+t+"："+n+")</div>","提示")}function getErrMsg(e,n){var t="操作结果！<br>";return void 0!=e&&null!=e&&e.length>0&&(t+="结果代码："+e+"<br>"),void 0!=n&&null!=n&&n.length>0&&(t+="结果信息："+n),t}function changeColor(e,n){var t=document.getElementById(e);t.style.color=n}function findSize(e){var n=window.navigator.userAgent,t=n.indexOf("MSIE 7.0")!=-1,r=n.indexOf("MSIE 8.0")!=-1,r=n.indexOf("MSIE 9.0")!=-1,i=$("#"+e);if(t||r||r)return 0;var a=i[0];return byteSize=a.files[0].size,Math.ceil(byteSize/1024)}function validate(){var e=document.getElementById("file1").value;if(""==e){jAlert("<div id='popup_message'>请您先选择需要上传的文件！</div>","提示");var n=document.getElementById("file1");return n.outerHTML=n.outerHTML,!1}var t=getCert();if(!velidateNsrsbh(t))return!1;token=getCookie("token"),$("#token").val(token),$("#cert").val(t);var r=jungeIE();$("#flag").val(r);var i=e.substr(e.length-4);if(".xls"!=i){jAlert("<div id='popup_message'>您上传的文件类型不被允许，请转换为.xls(2003版EXCEL)文件！</div>","提示");var n=document.getElementById("file1");return n.outerHTML=n.outerHTML,!1}if(findSize("file1")>500){jAlert("<div id='popup_message'>您上传的文件太大，请上传小于500K的EXCEL文件！可以通过较少上传的缴款书数量来减少文件大小。</div>","提示");var n=document.getElementById("file1");return n.outerHTML=n.outerHTML,!1}return!0}function isValNull(e){return void 0==e||null==e||0==e.trim().length}function getInputDate(e){var n=$(e).val();/^\d{4}$/.test(n)?$(e).val(n+"-"):7==n.length&&4==n.indexOf("-")&&/^\d{2}$/.test(n.substr(5,7))&&$(e).val($(e).val()+"-")}function getCert(){var e="",n=getCookie("token"),t=n.split(TOKEN_SPLIT);return e=t[1]}function getCertFromSkp(){var e="";if(0==cryptType){var n=readCertInfoApi(71,!0,alg);0==n.code&&(e=n.certInfo)}else{var t=(openDevice(),CryptCtrl.GetCertInfo("",71),CryptCtrl.errCode),e="";0==t&&(e=CryptCtrl.strResult),CryptCtrl.CloseDevice()}return e}var dlfs=1,MENUSPLIT="~",floatObj=function(){function e(e){return Math.floor(e)===e}function n(n){var t={times:1,num:0};if(e(n))return t.num=n,t;var r=n+"",i=r.indexOf("."),a=r.substr(i+1).length,o=Math.pow(10,a),s=parseInt(n*o+.5,10);return t.times=o,t.num=s,t}function t(e,t,r){var i=n(e),a=n(t),o=i.num,s=a.num,u=i.times,d=a.times,c=u>d?u:d,l=null;switch(r){case"add":return l=u===d?o+s:u>d?o+s*(u/d):o*(d/u)+s,l/c;case"subtract":return l=u===d?o-s:u>d?o-s*(u/d):o*(d/u)-s,l/c;case"multiply":return l=o*s/(u*d);case"divide":return l=o/s*(d/u)}}function r(e,n){return t(e,n,"add")}function i(e,n){return t(e,n,"subtract")}function a(e,n){return t(e,n,"multiply")}function o(e,n){return t(e,n,"divide")}return{add:r,sub:i,multi:a,divide:o}}();